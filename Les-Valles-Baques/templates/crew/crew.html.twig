{% extends 'base.html.twig' %}
{% block my_crew %}active{% endblock %}
{% block title %}Mes groupes{% endblock %}
{# TODO requet custom pour reduire le nombre de requets #}
{% block body %}

<main class="bubble col-12 col-md-8 offset-md-2">

    {% for message in app.flashes('success') %}
    <div class="m-flash alert alert-success">
        {{ message }}
    </div>
    {% endfor %}

    {% for message in app.flashes('danger') %}
    <div class="m-flash alert alert-danger">
        {{ message }}
    </div>
    {% endfor %}

    <div class="m-1 border border-primary row brad">
        {# Si createur la div modifier s'affiche #}
        <div class="col-2 p-2">
            {% if null != crew.avatar %}

            <img src="{{ vich_uploader_asset(crew, 'avatarFile') | imagine_filter('small_square') }}" alt="avatar de {{ userCrews[0].crew.name }}"
                class="brad m-2">
            {% else %}
            <img src="{{ asset('/images/avatar1.png') | imagine_filter('small_square') }}" alt="avatar de {{ userCrews[0].crew.name }}"
                class="brad  m-2">
            {% endif %}
        </div>
        <div class=" bubble-title col-9 p-2 ">
            <u>
                <h3>{{ userCrews[0].crew.name }}</h3>
            </u>
            <p><u><ins>crée le :</ins></u> {{ userCrews[0].crew.createdAt|date('d/m/Y') }}</p>
            <p><u><ins>Description:</ins></u> {{ userCrews[0].crew.description }}</p>
        </div>
    </div>
    </div>
    </div>



    <div id="accordion">
        <h3 class="m-1 border border-primary brad p-2"><u>quizz</u> du groupe</h3>
        <div class="brad m-1">
            <table class="table">
                <thead class="thead">
                    <tr>
                        <th scope="col"><u>Quizzes</u></th>
                        <th class=" d-none d-lg-table-cell" scope="col"><u>Catégories</u></th>
                        <th scope="col"><u>Niveaux</u></th>
                        <th class=" d-none d-md-table-cell" scope="col"><u>Like</u></th>
                        <th scope="col"><u>score</u></th>
                        <th scope="col"><u>Jouer</u></th>
                    </tr>
                </thead>
<tbody>
    <tr>
        {% for q in quizzs %}
        <th scope="row">
            {{q.title}}
        </th>
        <td class="d-none d-lg-table-cell">
            {#TODO a effacer le temps de régler les sql#}
            {% if q.category.name is defined %}
            {{q.category.name}}
            {% endif %}

        </td>

        <td>{{q.level.name}}</td>
        <td class="d-none d-md-table-cell">
            {{ q.nbrLikes }}
        </td>

        <td>
            {{ myScores[q.id]|round(1, 'floor') }}

        </td>
        <td>
            {% if is_granted('ROLE_USER') %}
            <a href="{{path('quizz_show',{'id':q.id})}}">
                <button class="btn btn-success" type="button">
                    Go !
                </button>
            </a>
            {% else %}
            <button class="btn btn-success" type="button">
                <a href="{{path('security_signup')}}"></a>Inscris-toi pour jouer</a>
            </button>
            {% endif %}
        </td>
    </tr>
    {% endfor %}

</tbody>
            </table>

            {% if userCrews|length < 2 %} <span href="#" class="text-primary h3">
                <i class="fas fa-sad-tear  mr-1"></i><br /><u>Oh </u>... tu es tout seul ? <a href="{{ path('list_users_free', {'id' : crew.id } ) }}">invite
                    du monde <i class="fas fa-users"></i></a>
                </span>
                {% elseif roleUserActif <= 2 %} <a href="{{ path('list_users_free', {'id' : crew.id } ) }}">invite plus
                    du monde <i class="fas fa-users m-1"></i></a> pour faire grandir ton groupe
                    {% endif %}
        </div>

        <h3 class="m-1 my-2 border border-primary brad p-2"><u>membres</u></h3>





        <div class="brad m-1">


</main>
{% endblock %}